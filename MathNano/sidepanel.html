<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-R">
	<link rel="stylesheet" href="lib/tailwind/tailwind.min.css">
	<style>
		body {
			margin: 0;
			padding: 0;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
		}

		/* MODERN PREVIEW BOX STYLE */
		#preview-container {
			min-height: 150px;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 1rem;
		}

		#mathjax-render {
			padding: 0;
		}

		.empty-state {
			color: #9ca3af;
			font-style: italic;
		}

		/* Modal Styles (Unchanged) */
		.modal-overlay {
			position: fixed;
			inset: 0;
			background-color: rgba(0, 0, 0, 0.5);
			z-index: 40;
		}

		.modal-container {
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			background-color: white;
			border-radius: 0.5rem;
			box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
			z-index: 50;
			width: 90%;
			max-width: 500px;
			padding: 1.5rem;
		}

		#drawing-canvas {
			border: 2px dashed #cbd5e1;
			border-radius: 0.375rem;
			cursor: crosshair;
			touch-action: none;
		}

		.hidden {
			display: none;
		}

		/* Compact Icon Buttons (Unchanged) */
		.compact-btn {
			width: 2.5rem;
			height: 2.5rem;
			display: flex;
			align-items: center;
			justify-content: center;
			border-radius: 0.5rem;
			transition-duration: 150ms;
		}

		.compact-btn-icon {
			font-size: 1.25rem;
			line-height: 1;
		}

		/* --- NEW: Style for settings modal form --- */
		.setting-item {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 1rem;
		}

		.setting-item label {
			font-size: 0.875rem;
			font-weight: 500;
			color: #374151;
		}

		.setting-item input[type="color"] {
			width: 3rem;
			height: 2rem;
			padding: 0.25rem;
			border: 1px solid #d1d5db;
			border-radius: 0.375rem;
			cursor: pointer;
		}

		.setting-item input[type="number"] {
			width: 6rem;
			font-size: 0.875rem;
			border: 1px solid #d1d5db;
			border-radius: 0.375rem;
			padding: 0.5rem;
			text-align: right;
		}
	</style>
</head>

<body class="bg-gray-50">
	<div class="max-w-2xl mx-auto p-6 space-y-6">
		<div class="text-center">
			<h1 class="text-3xl font-bold text-gray-900 mb-2">MathNano AI</h1>
			<p class="text-gray-600 text-sm">Your AI assistant for effortless math expression.</p>
		</div>

		<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-5">
			<label class="block text-sm font-semibold text-gray-700 mb-2 pl-2">LaTeX Input</label>

			<div
				class="w-full rounded-md border border-gray-300 overflow-hidden focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent">

				<textarea id="latex-input" placeholder="Enter your LaTeX equation here... (e.g., E = mc^2)"
					class="w-full h-32 px-3 py-2 border-0 outline-none resize-none font-mono text-sm focus:ring-0"></textarea>

				<div class="grid grid-cols-2 sm:grid-cols-4 gap-3 p-3 border-t border-gray-200 bg-gray-50">

					<button id="draw-btn"
						class="flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium text-sm hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500">
						<img src="svg/pen.svg" alt="" class="w-5 h-5 mr-2" />
						<span>Handwrite</span>
					</button>

					<button id="crop-btn"
						class="flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium text-sm hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500">
						<img src="svg/crop.svg" alt="" class="w-5 h-5 mr-2" />
						<span>Crop</span>
					</button>
					<button id="record-audio-btn"
						class="flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium text-sm hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500">
						<img src="svg/mic.svg" alt="" class="w-5 h-5 mr-2" />
						<span>Speech</span>
					</button>

					<button id="intelligent-ask-btn"
						class="flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium text-sm hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500">
						<img src="svg/chat.svg" alt="" class="w-5 h-5 mr-2" />
						<span>Ask</span>
					</button>

				</div>
			</div>
		</div>

		<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-5">

			<div class="flex justify-between items-center mb-3">

				<button id="settings-btn" title="Image Settings"
					class="flex items-center gap-1.5 px-2 py-1.5 text-sm font-medium text-gray-500 rounded-lg hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500">
					
					<img src="svg/setting.svg" alt="" class="w-5 h-5" />
					<span>Settings</span>

				</button>

				<button id="clear-btn"
					class="text-sm font-medium text-gray-500 hover:text-red-600 transition-colors focus:outline-none pr-2">
					Clear All
				</button>
				
			</div>

			<div id="preview-container" class="bg-gray-50 rounded-lg border border-gray-300 shadow-inner mb-5">
				<div id="mathjax-render"></div>
				<div id="empty-state" class="empty-state">Type LaTeX above to see a live preview</div>
			</div>

			<div class="grid grid-cols-2 gap-3">
				<button id="copy-btn" disabled
					class="flex items-center justify-center gap-2 px-4 py-2.5 bg-white border border-blue-600 text-blue-600 rounded-lg font-medium hover:bg-blue-50 transition-colors disabled:border-gray-300 disabled:text-gray-400 disabled:bg-gray-50 disabled:cursor-not-allowed">
					<img src="svg/copy.svg" alt="" class="w-5 h-5" />
					Copy Image
				</button>
				<button id="download-btn" disabled
					class="flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed">
					<img src="svg/download.svg" alt="" class="w-5 h-5" />
					Download
				</button>
			</div>

			<div id="message" class="mt-3 p-3 rounded-lg text-sm font-medium hidden"></div>
		</div>

	</div>

	<div id="drawing-modal-overlay" class="modal-overlay hidden"></div>
	<div id="drawing-modal" class="modal-container hidden">
		<h3 class="text-lg font-medium text-gray-900 mb-4">Draw your Equation</h3>
		<canvas id="drawing-canvas" width="450" height="250"></canvas>
		<div class="flex gap-2 mt-4">
			<button id="process-drawing-btn"
				class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors text-sm">
				Process Drawing
			</button>
			<button id="clear-drawing-btn"
				class="flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg font-medium hover:bg-gray-300 transition-colors text-sm">
				Clear
			</button>
			<button id="close-modal-btn"
				class="flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors text-sm">
				Close
			</button>
		</div>
	</div>

	<div id="intelligent-ask-overlay" class="modal-overlay hidden"></div>
	<div id="intelligent-ask-modal" class="modal-container hidden">
		<h3 class="text-lg font-medium text-gray-900 mb-4">Ask for a Formula</h3>
		<p class="text-sm text-gray-600 mb-4">Type your request in natural language (e.g., "quadratic formula" or
			"sigmoid function").</p>
		<textarea id="intelligent-ask-input" placeholder="e.g., formula for the area of a circle"
			class="w-full h-24 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none font-sans text-sm"></textarea>
		<div class="flex gap-2 mt-4">
			<button id="intelligent-ask-submit-btn"
				class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors text-sm">
				Get LaTeX
			</button>
			<button id="intelligent-ask-close-btn"
				class="flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors text-sm">
				Cancel
			</button>
		</div>
	</div>

	<div id="recording-overlay" class="modal-overlay hidden flex flex-col items-center justify-center"
		style="z-index: 90; background-color: rgba(0, 0, 0, 0.75); backdrop-filter: blur(5px);">
		<div class="animate-pulse flex items-center justify-center w-20 h-20 bg-red-500 rounded-full mb-6 shadow-lg">
			<img src="svg/mic.svg" alt="Recording" class="w-10 h-10 text-white" />
		</div>
		<p class="text-white text-2xl font-medium mb-8">Recording in progress...</p>

		<button id="stop-record-btn" title="Stop Recording"
			class="flex items-center justify-center gap-3 px-8 py-4 bg-gray-100 text-gray-900 rounded-lg font-bold text-lg hover:bg-gray-200 transition-colors focus:outline-none focus:ring-4 focus:ring-gray-300 shadow-xl">
			<span class="flex items-center justify-center w-5 h-5 bg-gray-800 rounded-sm">
				<img src="svg/stop.svg" alt="Stop" class="w-3 h-3 text-white" />
			</span>
			Stop Recording
		</button>
	</div>
	<div id="global-loading-overlay" class="modal-overlay hidden flex items-center justify-center"
		style="z-index: 100;">
		<div class="bg-gray-800 text-white text-lg font-medium p-6 rounded-lg shadow-xl flex items-center gap-4">
			<img src="svg/spin.svg" alt="Loading" class="w-6 h-6 animate-spin" />
			<span>Processing AI Request...</span>
		</div>
	</div>

	<div id="settings-modal-overlay" class="modal-overlay hidden"></div>
	<div id="settings-modal" class="modal-container hidden">
		<h3 class="text-lg font-medium text-gray-900 mb-6">Image Settings</h3>

		<div class="space-y-4">
			<div class="setting-item">
				<label for="setting-padding">Padding (px)</label>
				<input type="number" id="setting-padding" min="0" step="1" value="10"
					class="w-24 px-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
			</div>

			<div class="setting-item">
				<label for="setting-scale">Scale</label>
				<input type="number" id="setting-scale" min="0.5" step="0.1" value="1.0"
					class="w-24 px-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
			</div>

			<div class="setting-item">
				<label for="setting-font-color">Font Color</label>
				<input type="color" id="setting-font-color" value="#000000">
			</div>

			<div class="setting-item">
				<label for="setting-bg-color">Background Color</label>
				<input type="color" id="setting-bg-color" value="#FFFFFF">
			</div>

			<div class="setting-item">
				<label for="setting-transparent-bg">Transparent Background</label>
				<input type="checkbox" id="setting-transparent-bg" class="w-5 h-5 text-blue-600 rounded">
			</div>
		</div>

		<div class="flex gap-2 mt-8">
			<button id="settings-save-btn"
				class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors text-sm">
				Save
			</button>
			<button id="settings-close-btn"
				class="flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors text-sm">
				Cancel
			</button>
		</div>
	</div>
	<script>
		window.MathJax = {
			tex: {
				inlineMath: [['$', '$'], ['\\(', '\\)']],
				displayMath: [['$$', '$$'], ['\\[', '\\]']]
			},
			svg: {
				fontCache: 'global' // Use 'global' cache for better performance
			}
		};
	</script>
	<script src="lib/mathjax/tex-svg.js" id="MathJax-script" async></script>

	<script src="sidepanel.js"></script>
</body>

</html>